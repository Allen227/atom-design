"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,require("./style.css");var _default={name:"atom-carousel",data:function(){return{preMoveX:0,tempMoveX:0,touchStartX:0,touchStartY:0,activeIdx:0,timer:null,length:null,isMounted:!1,canMove:!0}},props:{isTabs:{type:Boolean,default:!1},value:{type:Number,default:0},isLock:{type:Boolean,default:!1},height:{type:Number,default:200},loop:{type:Boolean,default:!1},pagination:{type:Boolean,default:!1},auto:{type:Boolean,default:!1},duration:{type:Number,default:300},time:{type:Number,default:3e3}},watch:{value:function(t){this.isTabs&&this.changeIndex()},activeIdx:function(t){this.$emit("input",t)}},mounted:function(){this.changeIndex(!0),this.initAutoAnim()},methods:{changeIndex:function(t){var e=this.$el.children.item(0);this.preMoveX=-1*e.offsetWidth*this.value,t||(e.style["transition-duration"]="".concat(this.duration,"ms")),e.style.transform="translate3d(".concat(this.preMoveX,"px, 0, 0)")},startAnim:function(){clearTimeout(this.timer),this.auto&&this.animation()},initAutoAnim:function(){this.startAnim()},animation:function(){var a=this,o=this.$el.children.item(0);this.timer=setTimeout(function(){var t,e=a.preMoveX-o.offsetWidth;t=a.loop?(a.handleLoop(e),a.preMoveX-o.offsetWidth):Math.abs(e)>o.offsetWidth*(a.length-1)?a.preMoveX=0:a.preMoveX-o.offsetWidth,a.activeIdx=Math.abs(t)/o.offsetWidth,a.loop&&a.activeIdx>=a.length-1&&(a.activeIdx=0),o.style["transition-duration"]="".concat(a.duration,"ms"),o.style.transform="translate3d(".concat(t,"px, 0, 0)"),a.listenAnimEnd(t)},this.time)},handleLoop:function(t){var e=this.$el.children.item(0);Math.abs(t)>e.offsetWidth*(this.length-1)?(this.preMoveX=0,e.style.transform="translate3d(0, 0, 0)"):0<t&&(this.preMoveX=-1*e.offsetWidth*(this.length-1))},listenAnimEnd:function(t){var e=this,a=this.$el.children.item(0);document.addEventListener("transitionend",function(){e.preMoveX=t,e.tempMoveX=0,a.style["transition-duration"]="0ms",e.startAnim()},{capture:!1,once:!0})}},render:function(a){var t,n=this,s=this.$slots.default&&this.$slots.default.map(function(t,e){if(void 0!==t.tag)return a("li",{staticClass:"atom-carousel-item"},[t])}).filter(function(t,e){if(void 0!==t)return t}),e=[];if(s){for(var o=0;o<s.length;o++)e.push(a("li",{class:["point",{"is-active":this.activeIdx===o}]}));t=this.pagination?a("ul",{staticClass:"pagination-point-wrapper"},e):void 0,this.loop&&s.push(s[0])}return this.length=s&&s.length||0,a("div",{staticClass:"atom-carousel"},[a("ul",{staticClass:"atom-carousel-wrapper",on:{touchstart:function(){n.timer&&clearTimeout(n.timer),!n.isLock&&n.canMove&&(n.touchStartX=event.targetTouches[0].pageX,n.touchStartY=event.targetTouches[0].pageY)},touchmove:function(){if(!n.isLock){var t=event.currentTarget,e=event.changedTouches[0].pageX;n.tempMoveX=e-n.touchStartX;var a=event.changedTouches[0].pageY-n.touchStartY,o=Math.abs(n.tempMoveX);if(o<5||5<=o&&1.73*o<=a?n.canMove=!1:event.cancelable&&(n.canMove=!0,event.preventDefault()),n.canMove){var i=n.tempMoveX+n.preMoveX;n.loop||!(0<i||Math.abs(i)>t.offsetWidth*(s.length-1))?(n.loop&&n.handleLoop(i),t.style.transform="translate3d(".concat(i,"px, 0, 0)")):n.tempMoveX=0}}},touchend:function(){if(!n.isLock&&n.canMove){var t=event.currentTarget,e=Math.abs(n.tempMoveX)>t.offsetWidth/2?0<n.tempMoveX?n.preMoveX+t.offsetWidth:n.preMoveX-t.offsetWidth:n.preMoveX;n.activeIdx=Math.abs(e)/t.offsetWidth,n.loop&&n.activeIdx>=n.length-1&&(n.activeIdx=0),t.style["transition-duration"]="".concat(n.duration,"ms"),t.style.transform="translate3d(".concat(e,"px, 0, 0)"),n.listenAnimEnd(e)}}}},s),t])}};exports.default=_default;